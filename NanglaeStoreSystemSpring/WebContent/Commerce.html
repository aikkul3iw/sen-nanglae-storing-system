<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<script type='text/javascript' src="js/jquery.js"></script>
<script type='text/javascript'>
	function listCommerce() {
		$("#loader").show();
		$.ajax({
			url : "listCommerce.do",
			type : "POST",
			success : function(data) {
				var html = '';
				for (var i = 0; i < data.length; i++) {
					html += "<tr>";
					html += "<td>" + data[i].com_year + "</td>" + "<td>"
							+ data[i].com_name + "</td>" + "<td>"
							+ data[i].com_type + "</td>" + "<td>"
							+ data[i].com_house_number + "</td>" + "<td>"
							+ data[i].com_description + "</td>" + "<td>"
							+ data[i].location.vil_name + "</td>"
							+ "<td><buttun onclick=\"deleteCommerce("
							+ data[i].com_id + ");\" >Delete</button></td>"
							+ "<td><buttun onclick=\"setEditCommerce("
							+ data[i].com_id + ");\" >Edit</button></td>";
					html += "</tr>";
				}
				$('#resultTable').html(html);
				$("#loader").hide();
			},
			error : function(data, status, er) {
				alert('error');
				$("#loader").hide();
			}
		});
	}
</script>
<script type='text/javascript'>
	function createCommerce() {
		$("#loader").show();
		var obj = {
			com_id : 0,
			com_year : $('#com_year').val(),
			com_name : $('#com_name').val(),
			com_type : $('#com_type').val(),
			com_house_number : $('#com_house_number').val(),
			com_description : $('#com_description').val()

		};
		//alert(JSON.stringify(obj));
		$.ajax({
			url : "saveCommerce.do?id=" + $("#villageSelect").val(),
			type : "POST",
			dataType : "JSON",
			data : JSON.stringify(obj),
			contentType : "application/json",
			mimeType : "application/json",
			success : function(data) {
				//alert('success');
				$("#loader").hide();
			},
			error : function(data, status, er) {
				alert('error');
				$("#loader").hide();
			}
		});
	}
	function listVillage() {
		$("#loader").show();
		$.ajax({
			url : "listVillage.do",
			type : "POST",
			success : function(data) {
				var html = '';
				for (var i = 0; i < data.length; i++) {
					html += "<option value=\""+data[i].vil_id+"\">"
							+ data[i].vil_name + "</option>";
				}
				$('#villageSelect').html(html);

			},
			error : function(data, status, er) {
				alert('error');
				$("#loader").hide();
			}
		});
	}
	function deleteCommerce(id) {
		var obj = {
			com_id : id

		};
		//alert(id);
		//alert(JSON.stringify(obj));
		$.ajax({
			url : "../deleteCommerce.do",
			type : "POST",
			dataType : "JSON",
			data : JSON.stringify(obj),
			contentType : "application/json",
			mimeType : "application/json",
			success : function(data) {
				alert('success');
				location.reload();
			}
		});
	}
	function editCommerce() {
		var obj = {
			com_id : $("#editComId").val(),
			com_year : $('#editComYear').val(),
			com_name : $('#editComName').val(),
			com_type : $('#editComType').val(),
			com_house_number : $('#editComHouseNumber').val(),
			com_description : $('#editComDescription').val()
		};
		//alert(JSON.stringify(obj));
		$.ajax({
			url : "saveCommerce.do?id=" + $("#editVillageSelect").val(),
			type : "POST",
			dataType : "JSON",
			data : JSON.stringify(obj),
			contentType : "application/json",
			mimeType : "application/json",
			success : function(data) {
				//alert('success');
				location.reload();
			},
			error : function(data, status, er) {
				alert('error');
			}
		});
	}
	function setEditCommerce(com_id) {

		var obj = {
			com_id : com_id
		};

		$.ajax({
			url : "findCommerce.do",
			type : "POST",
			dataType : "JSON",
			data : JSON.stringify(obj),
			contentType : "application/json",
			mimeType : "application/json",
			success : function(data) {
				//alert(JSON.stringify(data));
				$("#editComId").val(data.com_id);
				$("#editComYear").val(data.com_year);
				$("#editComName").val(data.com_name);
				$("#editComType").val(data.com_type);
				$("#editComHouseNumber").val(data.com_house_number);
				$("#editComDescription").val(data.com_description);
			},
			error : function(data, status, er) {
				alert('error');
			}
		});
	}
	function editVillageSelect() {
		$("#loader").show();
		$.ajax({
			url : "listVillage.do",
			type : "POST",
			success : function(data) {
				var html = '';
				for (var i = 0; i < data.length; i++) {
					html += "<option value=\""+data[i].vil_id+"\">"
							+ data[i].vil_name + "</option>";
				}
				$('#editVillageSelect').html(html);

			},
			error : function(data, status, er) {
				alert('error');
				$("#loader").hide();
			}
		});
	}
</script>
</head>
<body onload="listCommerce();listVillage();editVillageSelect();">
	<div id="loader" style="display: none">
		<img src="image/ajax-loader.gif" />
	</div>
	<table id="resultTable" border="1"></table>

	<button onclick="listCommerce()">Fetch All</button>

	<div id="loader" style="display: none">
		<img src="image/ajax-loader.gif" />
	</div>
	<table id="resultTable" border="1"></table>

	<hr />
	Year:
	<input type="text" id="com_year">
	<BR /> Name:
	<input type="text" id="com_name">
	<BR /> Type:
	<input type="text" id="com_type">
	<BR /> House Number:
	<input type="text" id="com_house_number">
	<BR /> Description:
	<input type="text" id="com_description">
	<BR /> Location:
	<select id="villageSelect">
	</select>
	<BR />
	<input type="button" value="Save" onclick="createCommerce()" />

	<hr />
	<input type="hidden" id="editComId"> Year:
	<input type="text" id="editComYear">
	<BR /> Name:
	<input type="text" id="editComName">
	<BR /> Type:
	<input type="text" id="editComType">
	<BR /> House Number:
	<input type="text" id="editComHouseNumber">
	<BR /> Description:
	<input type="text" id="editComDescription">
	<BR /> Location:
	<select id="editVillageSelect">
	</select>
	<BR />
	<input type="button" value="Save" onclick="editCommerce()" />

</body>
</html>